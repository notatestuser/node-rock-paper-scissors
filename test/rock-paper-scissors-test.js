// Generated by CoffeeScript 1.3.3
(function() {
  var RockPaperScissors, assert, getGameInstance, vows;

  vows = require('vows');

  assert = require('assert');

  RockPaperScissors = require('../lib/rock-paper-scissors');

  getGameInstance = function(shufflePlayers) {
    var weaponSet;
    weaponSet = require('../lib/weapon-sets/traditional-set');
    return new RockPaperScissors(weaponSet, shufflePlayers);
  };

  vows.describe('RockPaperScissorsTest').addBatch({
    'An instance of RockPaperScissors in "no shuffle" mode': {
      topic: getGameInstance(false),
      'containing no players to fight': {
        topic: function(game) {
          return game.clearPlayers();
        },
        'playRound() returns an empty array': function(game) {
          return assert.deepEqual(game.playRound(), []);
        },
        'and outputs an appropriate "everyone died" message': function(game) {
          return assert.equal(game.playRoundForText(), 'All players have killed each other - nobody wins');
        },
        'is a "game over" situation': function(game) {
          return assert.ok(game.isGameOver());
        },
        'and a player is added': {
          topic: function(game) {
            return game.addPlayer('Paul Phoenix', 'Paper');
          },
          'playRound() returns an array containing one player': function(game) {
            return assert.deepEqual(game.playRound(), [
              {
                name: 'Paul Phoenix',
                weapon: 'Paper',
                alive: true
              }
            ]);
          },
          'we have a "game over" situation': function(game) {
            return assert.ok(game.isGameOver());
          },
          'and another two players are added': {
            topic: function(game) {
              return game.addPlayer('Prototype Jack', 'Scissors').addPlayer('Nina Williams', 'Rock');
            },
            'playRound() returns two players upon being called to fight': function(game) {
              return assert.deepEqual(game.playRound(), [
                {
                  name: 'Paul Phoenix',
                  weapon: 'Paper',
                  alive: false
                }, {
                  name: 'Prototype Jack',
                  weapon: 'Scissors',
                  alive: true
                }
              ]);
            },
            'we do not have a "game over" situation': function(game) {
              return assert.ok(!game.isGameOver());
            },
            'and post-fight': {
              'playRoundForText() describes the final fight if called to fight again': function(game) {
                return assert.equal(game.playRoundForText(), "Nina Williams's Rock crushes Prototype Jack's Scissors");
              },
              'and finally': {
                'there is only one true victor': function(game) {
                  return assert.equal(game.playRoundForText(), "Nina Williams has won the game with their Rock");
                },
                'and we have a "game over" situation': function(game) {
                  return assert.ok(game.isGameOver());
                }
              }
            }
          }
        }
      }
    }
  })["export"](module);

}).call(this);
